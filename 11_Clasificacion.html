<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.3.450">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <meta name="author" content="Andrés Quintero-Zea">
    <meta name="dcterms.date" content="2024-09-09">

    <title>Modelos de clasificación</title>
    <style>
        code {
            white-space: pre-wrap;
        }

        span.smallcaps {
            font-variant: small-caps;
        }

        div.columns {
            display: flex;
            gap: min(4vw, 1.5em);
        }

        div.column {
            flex: auto;
            overflow-x: auto;
        }

        div.hanging-indent {
            margin-left: 1.5em;
            text-indent: -1.5em;
        }

        ul.task-list {
            list-style: none;
        }

        ul.task-list li input[type="checkbox"] {
            width: 0.8em;
            margin: 0 0.8em 0.2em -1em;
            /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */
            vertical-align: middle;
        }

        /* CSS for syntax highlighting */
        pre>code.sourceCode {
            white-space: pre;
            position: relative;
        }

        pre>code.sourceCode>span {
            display: inline-block;
            line-height: 1.25;
        }

        pre>code.sourceCode>span:empty {
            height: 1.2em;
        }

        .sourceCode {
            overflow: visible;
        }

        code.sourceCode>span {
            color: inherit;
            text-decoration: inherit;
        }

        div.sourceCode {
            margin: 1em 0;
        }

        pre.sourceCode {
            margin: 0;
        }

        @media screen {
            div.sourceCode {
                overflow: auto;
            }
        }

        @media print {
            pre>code.sourceCode {
                white-space: pre-wrap;
            }

            pre>code.sourceCode>span {
                text-indent: -5em;
                padding-left: 5em;
            }
        }

        pre.numberSource code {
            counter-reset: source-line 0;
        }

        pre.numberSource code>span {
            position: relative;
            left: -4em;
            counter-increment: source-line;
        }

        pre.numberSource code>span>a:first-child::before {
            content: counter(source-line);
            position: relative;
            left: -1em;
            text-align: right;
            vertical-align: baseline;
            border: none;
            display: inline-block;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            padding: 0 4px;
            width: 4em;
        }

        pre.numberSource {
            margin-left: 3em;
            padding-left: 4px;
        }


        @media screen {
            pre>code.sourceCode>span>a:first-child::before {
                text-decoration: underline;
            }
        }
    </style>

    <script src="assets/quarto-nav/quarto-nav.js"></script>
    <script src="assets/quarto-nav/headroom.min.js"></script>
    <script src="assets/clipboard/clipboard.min.js"></script>
    <script src="assets/quarto-search/autocomplete.umd.js"></script>
    <script src="assets/quarto-search/fuse.min.js"></script>
    <script src="assets/quarto-search/quarto-search.js"></script>
    <meta name="quarto:offset" content="./">
    <link href="./08_Matplotlib.html" rel="next">
    <link href="./10_Intro_DS.html" rel="prev">
    <script src="assets/quarto-html/quarto.js"></script>
    <script src="assets/quarto-html/popper.min.js"></script>
    <script src="assets/quarto-html/tippy.umd.min.js"></script>
    <script src="assets/quarto-html/anchor.min.js"></script>
    <link href="assets/quarto-html/tippy.css" rel="stylesheet">
    <link href="assets/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet"
        id="quarto-text-highlighting-styles">
    <script src="assets/bootstrap/bootstrap.min.js"></script>
    <link href="assets/bootstrap/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
    <script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"
        integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
        crossorigin="anonymous"></script>
    <script type="application/javascript">define('jquery', [], function () { return window.jQuery; })</script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>

</head>

<body class="nav-sidebar floating">

    <!-- content -->
    <div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
        <!-- sidebar -->
        <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
            <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
                <img src="./LogoNuevo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
                <div class="sidebar-title mb-0 py-0">
                    <a href="./index.html">Programación PRE2013A45</a>
                </div>
            </div>
            <div class="sidebar-menu-container">
                <ul class="list-unstyled mt-1">
                    <li class="sidebar-item sidebar-item-section">
                        <div class="sidebar-item-container">
                            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse"
                                data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
                                <span class="menu-text">Python</span></a>
                            <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse"
                                data-bs-target="#quarto-sidebar-section-1" aria-expanded="true"
                                aria-label="Toggle section">
                                <i class="bi bi-chevron-right ms-2"></i>
                            </a>
                        </div>
                        <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./01_Intro_Python.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span
                                                class="chapter-title">Introducción a Python</span></span></a>
                                </div>
                            </li>
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./02_Estructuras_control.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span
                                                class="chapter-title">Estructuras de control</span></span></a>
                                </div>
                            </li>
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./03_Funciones.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span
                                                class="chapter-title">Funciones</span></span></a>
                                </div>
                            </li>
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./04_Estructura_datos.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span
                                                class="chapter-title">Estructuras de datos avanzadas</span></span></a>
                                </div>
                            </li>
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./05_Archivos_excepciones.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span
                                                class="chapter-title">Manejo de archivos y excepciones</span></span></a>
                                </div>
                            </li>
                        </ul>
                    </li>
                    <li class="sidebar-item sidebar-item-section">
                        <div class="sidebar-item-container">
                            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse"
                                data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
                                <span class="menu-text">Análisis de Datos</span></a>
                            <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse"
                                data-bs-target="#quarto-sidebar-section-2" aria-expanded="true"
                                aria-label="Toggle section">
                                <i class="bi bi-chevron-right ms-2"></i>
                            </a>
                        </div>
                        <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./06_Numpy.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span
                                                class="chapter-title">Introducción a Numpy</span></span></a>
                                </div>
                            </li>
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./07_Pandas.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span
                                                class="chapter-title">Manipulación de datos con Pandas</span></span></a>
                                </div>
                            </li>
                                                        <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./08_Matplotlib.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span
                                                class="chapter-title">Visualización de datos con
                                                Matplotlib y Seaborn</span></span></a>
                                </div>
                            </li>
							<li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./09_EDA.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span
                                                class="chapter-title">Análisis exploratorio de datos</span></span></a>
                                </div>
                            </li>
                        </ul>
                    </li>
                    <li class="sidebar-item sidebar-item-section">
                        <div class="sidebar-item-container">
                            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse"
                                data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
                                <span class="menu-text">Ciencia de Datos</span></a>
                            <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse"
                                data-bs-target="#quarto-sidebar-section-3" aria-expanded="true"
                                aria-label="Toggle section">
                                <i class="bi bi-chevron-right ms-2"></i>
                            </a>
                        </div>
                        <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./10_Intro_DS.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span
                                                class="chapter-title">Introducción a la ciencia de
                                                datos</span></span></a>
                                </div>
                            </li>
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./11_Clasificacion.html" class="sidebar-item-text sidebar-link active">
                                        <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span
                                                class="chapter-title">Modelos de clasificación</span></span></a>
                                </div>
                            </li>
                            <li class="sidebar-item">
                                <div class="sidebar-item-container">
                                    <a href="./12_Regresion.html" class="sidebar-item-text sidebar-link">
                                        <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span
                                                class="chapter-title">Modelos de regresión</span></span></a>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
        <div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass">
        </div>
        <!-- margin-sidebar -->
        <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
            <nav id="TOC" role="doc-toc" class="toc-active">
                <h2 id="toc-title">Tabla de contenidos</h2>

                <ul>
                    <li><a href="#objetivo" id="toc-objetivo" class="nav-link active"
                            data-scroll-target="#objetivo">Objetivo</a></li>
                    <li><a href="#consejos-generales-sobre-matplotlib" id="toc-consejos-generales-sobre-matplotlib" class="nav-link"
                            data-scroll-target="#consejos-generales-sobre-matplotlib"><span class="header-section-number"> 8.1 </span> Consejos generales sobre Matplotlib </a></li>				
					<li><a href="#dos-interfaces-por-el-precio-de-una" id="toc-dos-interfaces-por-el-precio-de-una" class="nav-link"
                            data-scroll-target="#dos-interfaces-por-el-precio-de-una"><span class="header-section-number"> 8.2 </span> Dos interfaces por el precio de una </a>
                    </li>
					<li><a href="#gráficos-de-líneas-simples" id="toc-gráficos-de-líneas-simples" class="nav-link"
                            data-scroll-target="#gráficos-de-líneas-simples"><span class="header-section-number"> 8.3 </span> Gráficos de líneas simples </a>
                    </li>
					
					<li><a href="#diagramas-de-dispersión-simples" id="toc-diagramas-de-dispersión-simples" class="nav-link"
                            data-scroll-target="#diagramas-de-dispersión-simples"><span class="header-section-number"> 8.4 </span> Diagramas de dispersión simples </a>
                    </li>
					
					<li><a href="#visualizando-errores" id="toc-visualizando-errores" class="nav-link"
                            data-scroll-target="#visualizando-errores"><span class="header-section-number"> 8.5 </span> Visualizando errores</a>
                    </li>
					
					<li><a href="#gráficas-de-densidad-y-contorno" id="toc-gráficas-de-densidad-y-contorno" class="nav-link"
                            data-scroll-target="#gráficas-de-densidad-y-contorno"><span class="header-section-number"> 8.6 </span> Gráficas de densidad y contorno </a>
                    </li>
					
                    <li><a href="#histogramas-binnings-y-densidad" id="toc-histogramas-binnings-y-densidad" class="nav-link"
                            data-scroll-target="#histogramas-binnings-y-densidad"><span class="header-section-number"> 8.7 </span> Histogramas, binnings y densidad </a>
                    </li>
					
                    <li><a href="#personalización-de-leyendas" id="toc-personalización-de-leyendas" class="nav-link"
                            data-scroll-target="#personalización-de-leyendas"><span class="header-section-number"> 8.8 </span> Personalización de leyendas </a>
                    </li>
					
					<li><a href="#varias-subgráficas" id="toc-varias-subgráficas" class="nav-link"
                            data-scroll-target="#varias-subgráficas"><span class="header-section-number"> 8.9 </span> Varias subgráficas </a>
                    </li>
					
					<li><a href="#texto-y-anotaciones" id="toc-texto-y-anotaciones" class="nav-link"
                            data-scroll-target="#texto-y-anotaciones"><span class="header-section-number"> 8.10 </span> Texto y anotaciones </a>
                    </li>
					
					<li><a href="#personalización-de-ticks" id="toc-personalización-de-ticks" class="nav-link"
                            data-scroll-target="#personalización-de-ticks"><span class="header-section-number"> 8.11 </span> Personalización de ticks </a>
                    </li>
					
					<li><a href="#personalización-de-matplotlib" id="toc-personalización-de-matplotlib" class="nav-link"
                            data-scroll-target="#personalización-de-matplotlib"><span class="header-section-number"> 8.12 </span> Personalización de Matplotlib </a>
                    </li>
					
					<li><a href="#visualización-con-seaborn" id="toc-visualización-con-seaborn" class="nav-link"
                            data-scroll-target="#visualización-con-seaborn"><span class="header-section-number"> 8.13 </span> Visualización con Seaborn </a>
                    </li>
										
                    <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link"
                            data-scroll-target="#practice-exercises"><span class="header-section-number">8.14</span>
                            Ejercicios prácticos</a></li>
                </ul>
            </nav>
        </div>
        <!-- main -->
        <main class="content" id="quarto-document-content">

            <header id="title-block-header" class="quarto-title-block default">
                <div class="quarto-title">
                    <h1 class="title"><span class="chapter-number">11</span>&nbsp; <span
                            class="chapter-title">Modelos de clasificación</span></h1>
                </div>
                <div class="quarto-title-meta"> </div>
            </header>

            <section id="objetivo" class="level1">
                <h1 class="anchored" data-anchor-id="objetivo">Objetivo</h1>
                <p>

El objetivo de esta clase es que los estudiantes aprendan a aplicar técnicas de análisis exploratorio de datos en Python, utilizando herramientas como pandas, matplotlib y seaborn, para identificar patrones y relaciones clave en los datos.</p>
            </section>



<p>La clasificación es una tarea fundamental en el aprendizaje automático que implica asignar una categoría o etiqueta a cada observación en función de sus características. Se utiliza ampliamente en diversas aplicaciones, como el reconocimiento de imágenes y voz, el análisis de sentimientos, la detección de fraudes y muchas otras. En este módulo, nos sumergiremos en el mundo de los algoritmos de clasificación con Python y exploraremos algunos de los modelos más populares y potentes.</p>
<ol type="1">
<li>Logistic Regression</li>
<li>Artificial Neural Networks (Coming soon)</li>
<li>K-nearest Neighbors</li>
<li>Support Vector Machine</li>
<li>Decision Trees Classifier</li>
<li>Random Forest Classifier</li>
<li>XGBoost Classifier</li>
</ol>
<p><strong>Predicción de enfermedades cardíacas mediante aprendizaje automático</strong></p>
<p><strong>1. Definición del problema</strong></p>
<p>Dados los parámetros clínicos de un paciente, ¿podemos predecir si tiene o no una enfermedad cardíaca?</p>
<p><strong>2. Características</strong></p>
<p>Aquí obtendrá información diferente sobre cada una de las características de sus datos. Puede hacerlo investigando por su cuenta (por ejemplo, consultando los enlaces anteriores) o hablando con un experto en la materia (alguien que conozca el conjunto de datos).</p>
<ol type="1">
<li><code>age</code> - age in years</li>
<li><code>sex</code> - (1 = male; 0 = female)</li>
<li><code>cp</code> - chest pain type
<ul>
<li>0: Typical angina: chest pain related decrease blood supply to the heart</li>
<li>1: Atypical angina: chest pain not related to heart</li>
<li>2: Non-anginal pain: typically esophageal spasms (non heart related)</li>
<li>3: Asymptomatic: chest pain not showing signs of disease</li>
</ul></li>
<li><code>trestbps</code> - resting blood pressure (in mm Hg on admission to the hospital) anything above 130-140 is typically cause for concern</li>
<li><code>chol</code> - serum cholestoral in mg/dl
<ul>
<li>serum = LDL + HDL + .2 * triglycerides</li>
<li>above 200 is cause for concern</li>
</ul></li>
<li><code>fbs</code> - (fasting blood sugar &gt; 120 mg/dl) (1 = true; 0 = false)
<ul>
<li>‘&gt;126’ mg/dL signals diabetes</li>
</ul></li>
<li><code>restecg</code> - resting electrocardiographic results
<ul>
<li>0: Nothing to note</li>
<li>1: ST-T Wave abnormality
<ul>
<li>can range from mild symptoms to severe problems</li>
<li>signals non-normal heart beat</li>
</ul></li>
<li>2: Possible or definite left ventricular hypertrophy
<ul>
<li>Enlarged heart’s main pumping chamber</li>
</ul></li>
</ul></li>
<li><code>thalach</code> - maximum heart rate achieved</li>
<li><code>exang</code> - exercise induced angina (1 = yes; 0 = no)</li>
<li><code>oldpeak</code> - ST depression induced by exercise relative to rest looks at stress of heart during excercise unhealthy heart will stress more</li>
<li><code>slope</code> - the slope of the peak exercise ST segment
<ul>
<li>0: Upsloping: better heart rate with excercise (uncommon)</li>
<li>1: Flatsloping: minimal change (typical healthy heart)</li>
<li>2: Downslopins: signs of unhealthy heart</li>
</ul></li>
<li><code>ca</code> - number of major vessels (0-3) colored by flourosopy
<ul>
<li>colored vessel means the doctor can see the blood passing through</li>
<li>the more blood movement the better (no clots)</li>
</ul></li>
<li><code>thal</code> - thalium stress result
<ul>
<li>1,3: normal</li>
<li>6: fixed defect: used to be defect but ok now</li>
<li>7: reversable defect: no proper blood movement when excercising</li>
</ul></li>
<li><code>target</code> - have disease or not (1=yes, 0=no) (= the predicted attribute)</li>
</ol>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hvplot.pandas</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">'whitegrid'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'fivethirtyeight'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'heart.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="análisis-exploratorio-de-datos-eda" class="level2">
<h2 class="anchored" data-anchor-id="análisis-exploratorio-de-datos-eda">11.1 Análisis exploratorio de datos (EDA)</h2>
<p><strong>El objetivo aquí es obtener más información sobre los datos.</strong></p>
<ol type="1">
<li>¿Qué preguntas está intentando resolver?</li>
<li>¿Qué tipo de datos tenemos y cómo tratamos los diferentes tipos?</li>
<li>¿Qué falta en los datos y cómo se maneja?</li>
<li>¿Dónde están los valores atípicos y por qué deberían importarle?</li>
<li>¿Cómo puede agregar, cambiar o eliminar características para aprovechar al máximo sus datos?</li>
</ol>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-7" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.float'</span>, <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data.target.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data,x<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<ul>
<li>Tenemos 165 personas con enfermedades cardíacas y 138 personas sin ellas, por lo que nuestro problema está balanceado.</li>
<li>¡Parece el conjunto de datos perfecto! No hay valores nulos :-)</li>
</ul>
</blockquote>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>categorical_val <span class="op">=</span> []</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>continous_val <span class="op">=</span> []</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> data.columns:</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data[column].unique()) <span class="op">&lt;=</span> <span class="dv">10</span>:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        categorical_val.append(column)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        continous_val.append(column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-14" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>categorical_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data,x<span class="op">=</span><span class="st">'sex'</span>,hue<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data,x<span class="op">=</span><span class="st">'cp'</span>,hue<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-17" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data,x<span class="op">=</span><span class="st">'fbs'</span>,hue<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">7</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data,x<span class="op">=</span><span class="st">'age'</span>,y<span class="op">=</span><span class="st">'thalach'</span>,hue<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> data.corr()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.heatmap(corr_matrix,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                 vmin<span class="op">=-</span><span class="fl">1.0</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                 vmax<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                 annot<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                 linewidths<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                 fmt<span class="op">=</span><span class="st">'.2f'</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                 cmap<span class="op">=</span><span class="st">'YlGnBu'</span>)<span class="op">;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>bottom, top <span class="op">=</span> ax.get_ylim()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(bottom <span class="op">+</span> <span class="fl">0.5</span>, top <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="procesamiento-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="procesamiento-de-los-datos">11.2 Procesamiento de los datos</h2>
<p>Después de explorar el conjunto de datos, se observa que es necesario convertir algunas variables categóricas en variables ficticias y escalar todos los valores antes de entrenar los modelos de aprendizaje automático. Primero, usaremos el método <code>get_dummies</code> para crear columnas ficticias para las variables categóricas.</p>
<div id="cell-21" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>categorical_val.remove(<span class="st">'target'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> pd.get_dummies(data, columns <span class="op">=</span> categorical_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dataset.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.columns)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dataset.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-24" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>s_sc <span class="op">=</span> StandardScaler()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>col_to_scale <span class="op">=</span> [<span class="st">'age'</span>, <span class="st">'trestbps'</span>, <span class="st">'chol'</span>, <span class="st">'thalach'</span>, <span class="st">'oldpeak'</span>]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>dataset[col_to_scale] <span class="op">=</span> s_sc.fit_transform(dataset[col_to_scale])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-25" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dataset.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="construcción-de-los-modelos" class="level2">
<h2 class="anchored" data-anchor-id="construcción-de-los-modelos">11.3 construcción de los modelos</h2>
<div id="cell-27" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, confusion_matrix, classification_report, ConfusionMatrixDisplay</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_score(clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> train:</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> clf.predict(X_train)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        clf_report <span class="op">=</span> pd.DataFrame(classification_report(y_train, pred, output_dict<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Train Result:</span><span class="ch">\n</span><span class="st">================================================'</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Accuracy Score: </span><span class="sc">{</span>accuracy_score(y_train, pred) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'_______________________________________________'</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'CLASSIFICATION REPORT:</span><span class="ch">\n</span><span class="sc">{</span>clf_report<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'_______________________________________________'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Confusion Matrix:'</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> confusion_matrix(y_train, pred)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                              display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        disp.plot()</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">False</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> train<span class="op">==</span><span class="va">False</span>:</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        clf_report <span class="op">=</span> pd.DataFrame(classification_report(y_test, pred, output_dict<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Test Result:</span><span class="ch">\n</span><span class="st">================================================'</span>)        </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Accuracy Score: </span><span class="sc">{</span>accuracy_score(y_test, pred) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'_______________________________________________'</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'CLASSIFICATION REPORT:</span><span class="ch">\n</span><span class="sc">{</span>clf_report<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'_______________________________________________'</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Confusion Matrix:'</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> confusion_matrix(y_test, pred)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>        disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>                              display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        disp.plot()</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">False</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-28" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dataset.drop(<span class="st">'target'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> dataset.target</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora que tenemos nuestros datos divididos en conjuntos de entrenamiento y prueba, es hora de crear un modelo de aprendizaje automático. Lo entrenaremos (encontraremos los patrones) en el conjunto de entrenamiento. Y lo probaremos (usaremos los patrones) en el conjunto de prueba. Vamos a probar 3 modelos de aprendizaje automático diferentes:</p>
<ol type="1">
<li>Regresión logística</li>
<li>Clasificador de K vecinos más cercanos</li>
<li>Máquina de vectores de soporte</li>
<li>Clasificador de árbol de decisiones</li>
<li>Clasificador de bosque aleatorio</li>
<li>Clasificador XGBoost</li>
</ol>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">11.3.1 Logistic Regression</h3>
<div id="cell-31" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>lr_clf <span class="op">=</span> LogisticRegression(solver<span class="op">=</span><span class="st">'liblinear'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>lr_clf.fit(X_train, y_train)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>print_score(lr_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>print_score(lr_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-32" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, lr_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, lr_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>[[<span class="st">'Logistic Regression'</span>, train_score, test_score]], </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>])</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-nearest-neighbors" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors">11.3.2 K-nearest neighbors</h3>
<div id="cell-34" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>knn_clf <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>knn_clf.fit(X_train, y_train)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>print_score(knn_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>print_score(knn_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, knn_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, knn_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>[[<span class="st">'K-nearest neighbors'</span>, train_score, test_score]], </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>])</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="support-vector-machine" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine">11.3.3 Support Vector machine</h3>
<div id="cell-37" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>svm_clf <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>, gamma<span class="op">=</span><span class="fl">0.1</span>, C<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>svm_clf.fit(X_train, y_train)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>print_score(svm_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>print_score(svm_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-38" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, svm_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, svm_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>[[<span class="st">'Support Vector Machine'</span>, train_score, test_score]], </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="decision-tree-classifier" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree-classifier">11.3.4 Decision Tree Classifier</h3>
<div id="cell-40" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>tree_clf <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>tree_clf.fit(X_train, y_train)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>print_score(tree_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>print_score(tree_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-41" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, tree_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, tree_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>[[<span class="st">'Decision Tree Classifier'</span>, train_score, test_score]], </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>])</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest" class="level3">
<h3 class="anchored" data-anchor-id="random-forest">11.3.5 Random Forest</h3>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>rf_clf <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">1000</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>rf_clf.fit(X_train, y_train)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>print_score(rf_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>print_score(rf_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, rf_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, rf_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>[[<span class="st">'Random Forest Classifier'</span>, train_score, test_score]], </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>])</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xgboost-classifer" class="level3">
<h3 class="anchored" data-anchor-id="xgboost-classifer">11.3.6 XGBoost Classifer</h3>
<div id="cell-46" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>xgb_clf <span class="op">=</span> XGBClassifier()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>xgb_clf.fit(X_train, y_train)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>print_score(xgb_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>print_score(xgb_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-47" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, xgb_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, xgb_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>[[<span class="st">'XGBoost Classifier'</span>, train_score, test_score]], </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>])</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ajuste-de-hiperparámetros-de-los-modelos" class="level2">
<h2 class="anchored" data-anchor-id="ajuste-de-hiperparámetros-de-los-modelos">11.4 Ajuste de hiperparámetros de los modelos</h2>
<section id="logistic-regression-1" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-1">11.4.1 Logistic Regression</h3>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'C'</span>: np.logspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">20</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">'solver'</span>: [<span class="st">'liblinear'</span>]}</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>lr_clf <span class="op">=</span> LogisticRegression()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>lr_cv <span class="op">=</span> GridSearchCV(lr_clf, params, scoring<span class="op">=</span><span class="st">'accuracy'</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>lr_cv.fit(X_train, y_train)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> lr_cv.best_params_</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best parameters: </span><span class="sc">{</span>best_params<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>lr_clf <span class="op">=</span> LogisticRegression(<span class="op">**</span>best_params)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>lr_clf.fit(X_train, y_train)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>print_score(lr_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>print_score(lr_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-51" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, lr_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, lr_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>[[<span class="st">'Tuned Logistic Regression'</span>, train_score, test_score]], </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-nearest-neighbors-1" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors-1">11.4.2 K-nearest neighbors</h3>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> []</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> []</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>neighbors <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> neighbors:</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>k)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    train_score.append(accuracy_score(y_train, model.predict(X_train)))</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    test_score.append(accuracy_score(y_test, model.predict(X_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-54" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">4</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plt.plot(neighbors, train_score, label<span class="op">=</span><span class="st">'Train score'</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.plot(neighbors, test_score, label<span class="op">=</span><span class="st">'Test score'</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.xticks(np.arange(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">1</span>))</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of neighbors'</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Model score'</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>plt.show() </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Maximum KNN score on the test data: </span><span class="sc">{</span><span class="bu">max</span>(train_score)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-55" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>knn_clf <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">27</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>knn_clf.fit(X_train, y_train)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>print_score(knn_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>print_score(knn_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-56" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, knn_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, knn_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>[[<span class="st">'Tuned K-nearest neighbors'</span>, train_score, test_score]], </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="support-vector-machine-1" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-1">11.4.3 Support Vector Machine</h3>
<div id="cell-58" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>svm_clf <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>, gamma<span class="op">=</span><span class="fl">0.1</span>, C<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'C'</span>:(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>), </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">'gamma'</span>:(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>), </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">'kernel'</span>:(<span class="st">'linear'</span>, <span class="st">'poly'</span>, <span class="st">'rbf'</span>)}</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>svm_cv <span class="op">=</span> GridSearchCV(svm_clf, params, n_jobs<span class="op">=-</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>, verbose<span class="op">=</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>svm_cv.fit(X_train, y_train)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> svm_cv.best_params_</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best params: </span><span class="sc">{</span>best_params<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>svm_clf <span class="op">=</span> SVC(<span class="op">**</span>best_params)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>svm_clf.fit(X_train, y_train)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>print_score(svm_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>print_score(svm_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-59" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, svm_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, svm_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>[[<span class="st">'Tuned Support Vector Machine'</span>, train_score, test_score]], </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="decision-tree-classifier-1" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree-classifier-1">11.4.4 Decision Tree Classifier</h3>
<div id="cell-61" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'criterion'</span>:(<span class="st">'gini'</span>, <span class="st">'entropy'</span>), </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">'splitter'</span>:(<span class="st">'best'</span>, <span class="st">'random'</span>), </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_depth'</span>:(<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">20</span>))), </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">'min_samples_split'</span>:[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">'min_samples_leaf'</span>:<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">20</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>tree_clf <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>tree_cv <span class="op">=</span> GridSearchCV(tree_clf, params, scoring<span class="op">=</span><span class="st">'accuracy'</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>tree_cv.fit(X_train, y_train)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> tree_cv.best_params_</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best_params: </span><span class="sc">{</span>best_params<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>tree_clf <span class="op">=</span> DecisionTreeClassifier(<span class="op">**</span>best_params)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>tree_clf.fit(X_train, y_train)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>print_score(tree_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>print_score(tree_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-62" class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, tree_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, tree_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>[[<span class="st">'Tuned Decision Tree Classifier'</span>, train_score, test_score]], </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest-classifier" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-classifier">11.4.5 Random Forest Classifier</h3>
<div id="cell-64" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>n_estimators <span class="op">=</span> [<span class="dv">500</span>, <span class="dv">900</span>, <span class="dv">1100</span>, <span class="dv">1500</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>max_features <span class="op">=</span> [<span class="st">'auto'</span>, <span class="st">'sqrt'</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>max_depth <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="va">None</span>]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>min_samples_split <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>min_samples_leaf <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>params_grid <span class="op">=</span> {</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: n_estimators, </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_features'</span>: max_features,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: max_depth, </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_split'</span>: min_samples_split,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_leaf'</span>: min_samples_leaf</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>rf_clf <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>rf_cv <span class="op">=</span> GridSearchCV(rf_clf, params_grid, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span><span class="dv">5</span>, verbose<span class="op">=</span><span class="dv">1</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>rf_cv.fit(X_train, y_train)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> rf_cv.best_params_</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best parameters: </span><span class="sc">{</span>best_params<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>rf_clf <span class="op">=</span> RandomForestClassifier(<span class="op">**</span>best_params)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>rf_clf.fit(X_train, y_train)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>print_score(rf_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>print_score(rf_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-65" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, rf_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, rf_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>[[<span class="st">'Tuned Random Forest Classifier'</span>, train_score, test_score]], </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xgboost-classifier-hyperparameter-tuning" class="level3">
<h3 class="anchored" data-anchor-id="xgboost-classifier-hyperparameter-tuning">11.4.6 XGBoost Classifier Hyperparameter Tuning</h3>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span>stats.randint(<span class="dv">10</span>, <span class="dv">1000</span>),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span>stats.randint(<span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span>stats.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>xgb_clf <span class="op">=</span> XGBClassifier(use_label_encoder<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>xgb_cv <span class="op">=</span> RandomizedSearchCV(</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    xgb_clf, param_grid, cv<span class="op">=</span><span class="dv">5</span>, n_iter<span class="op">=</span><span class="dv">150</span>, </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">'accuracy'</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>xgb_cv.fit(X_train, y_train)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> xgb_cv.best_params_</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best paramters: </span><span class="sc">{</span>best_params<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>xgb_clf <span class="op">=</span> XGBClassifier(<span class="op">**</span>best_params)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>xgb_clf.fit(X_train, y_train)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>print_score(xgb_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>print_score(xgb_clf, X_train, y_train, X_test, y_test, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-68" class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> accuracy_score(y_test, xgb_clf.predict(X_test)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>train_score <span class="op">=</span> accuracy_score(y_train, xgb_clf.predict(X_train)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>results_df_2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>[[<span class="st">'Tuned XGBoost Classifier'</span>, train_score, test_score]], </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Training Accuracy %'</span>, <span class="st">'Testing Accuracy %'</span>]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.concat([results_df,results_df_2])</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="importancia-de-las-características-según-random-forest-y-xgboost" class="level2">
<h2 class="anchored" data-anchor-id="importancia-de-las-características-según-random-forest-y-xgboost">11.5 Importancia de las características según Random Forest y XGBoost</h2>
<div id="cell-70" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> feature_imp(df, model):</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    fi <span class="op">=</span> pd.DataFrame()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    fi[<span class="st">'feature'</span>] <span class="op">=</span> df.columns</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    fi[<span class="st">'importance'</span>] <span class="op">=</span> model.feature_importances_</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fi.sort_values(by<span class="op">=</span><span class="st">'importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-71" class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>feature_imp(X, rf_clf).plot(kind<span class="op">=</span><span class="st">'barh'</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">7</span>), legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-72" class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>feature_imp(X, xgb_clf).plot(kind<span class="op">=</span><span class="st">'barh'</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">7</span>), legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="practice-exercises" class="level2" data-number="11.6">
                <h2 data-number="11.6" class="anchored" data-anchor-id="practice-exercises"><span
                        class="header-section-number">11.6</span> Ejercicios prácticos </h2>
<ol type="1">
<li>Cree un nuevo Notebook.</li>
<li>Guarde el archivo como <strong>Ejercicios_practicos_clase_11.ipynb</strong>.</li>
<li>Asigne un título <strong>H1</strong> con su nombre.</li>
</ol>
<section id="practice-exercise-1" class="level3" data-number="11.6.1">
                    <h3 data-number="11.6.1" class="anchored" data-anchor-id="practice-exercise-1"><span
                            class="header-section-number">11.6.1 </span> Ejercicio práctico 1 </h3>
<p>Implemente dos modelos de clasificación usando la base de datos <a href="https://archive.ics.uci.edu/dataset/186/wine+quality"><i>Wine Quality</i></a>.</p>

</section>

        </main> <!-- /main -->
        <script id="quarto-html-after-body" type="application/javascript">
            window.document.addEventListener("DOMContentLoaded", function (event) {
                const toggleBodyColorMode = (bsSheetEl) => {
                    const mode = bsSheetEl.getAttribute("data-mode");
                    const bodyEl = window.document.querySelector("body");
                    if (mode === "dark") {
                        bodyEl.classList.add("quarto-dark");
                        bodyEl.classList.remove("quarto-light");
                    } else {
                        bodyEl.classList.add("quarto-light");
                        bodyEl.classList.remove("quarto-dark");
                    }
                }
                const toggleBodyColorPrimary = () => {
                    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
                    if (bsSheetEl) {
                        toggleBodyColorMode(bsSheetEl);
                    }
                }
                toggleBodyColorPrimary();
                const icon = "";
                const anchorJS = new window.AnchorJS();
                anchorJS.options = {
                    placement: 'right',
                    icon: icon
                };
                anchorJS.add('.anchored');
                const isCodeAnnotation = (el) => {
                    for (const clz of el.classList) {
                        if (clz.startsWith('code-annotation-')) {
                            return true;
                        }
                    }
                    return false;
                }
                const clipboard = new window.ClipboardJS('.code-copy-button', {
                    text: function (trigger) {
                        const codeEl = trigger.previousElementSibling.cloneNode(true);
                        for (const childEl of codeEl.children) {
                            if (isCodeAnnotation(childEl)) {
                                childEl.remove();
                            }
                        }
                        return codeEl.innerText;
                    }
                });
                clipboard.on('success', function (e) {
                    // button target
                    const button = e.trigger;
                    // don't keep focus
                    button.blur();
                    // flash "checked"
                    button.classList.add('code-copy-button-checked');
                    var currentTitle = button.getAttribute("title");
                    button.setAttribute("title", "Copied!");
                    let tooltip;
                    if (window.bootstrap) {
                        button.setAttribute("data-bs-toggle", "tooltip");
                        button.setAttribute("data-bs-placement", "left");
                        button.setAttribute("data-bs-title", "Copied!");
                        tooltip = new bootstrap.Tooltip(button,
                            {
                                trigger: "manual",
                                customClass: "code-copy-button-tooltip",
                                offset: [0, -8]
                            });
                        tooltip.show();
                    }
                    setTimeout(function () {
                        if (tooltip) {
                            tooltip.hide();
                            button.removeAttribute("data-bs-title");
                            button.removeAttribute("data-bs-toggle");
                            button.removeAttribute("data-bs-placement");
                        }
                        button.setAttribute("title", currentTitle);
                        button.classList.remove('code-copy-button-checked');
                    }, 1000);
                    // clear code selection
                    e.clearSelection();
                });
                function tippyHover(el, contentFn) {
                    const config = {
                        allowHTML: true,
                        content: contentFn,
                        maxWidth: 500,
                        delay: 100,
                        arrow: false,
                        appendTo: function (el) {
                            return el.parentElement;
                        },
                        interactive: true,
                        interactiveBorder: 10,
                        theme: 'quarto',
                        placement: 'bottom-start'
                    };
                    window.tippy(el, config);
                }
                const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
                for (var i = 0; i < noterefs.length; i++) {
                    const ref = noterefs[i];
                    tippyHover(ref, function () {
                        // use id or data attribute instead here
                        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
                        try { href = new URL(href).hash; } catch { }
                        const id = href.replace(/^#\/?/, "");
                        const note = window.document.getElementById(id);
                        return note.innerHTML;
                    });
                }
                let selectedAnnoteEl;
                const selectorForAnnotation = (cell, annotation) => {
                    let cellAttr = 'data-code-cell="' + cell + '"';
                    let lineAttr = 'data-code-annotation="' + annotation + '"';
                    const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
                    return selector;
                }
                const selectCodeLines = (annoteEl) => {
                    const doc = window.document;
                    const targetCell = annoteEl.getAttribute("data-target-cell");
                    const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
                    const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                    const lines = annoteSpan.getAttribute("data-code-lines").split(",");
                    const lineIds = lines.map((line) => {
                        return targetCell + "-" + line;
                    })
                    let top = null;
                    let height = null;
                    let parent = null;
                    if (lineIds.length > 0) {
                        //compute the position of the single el (top and bottom and make a div)
                        const el = window.document.getElementById(lineIds[0]);
                        top = el.offsetTop;
                        height = el.offsetHeight;
                        parent = el.parentElement.parentElement;
                        if (lineIds.length > 1) {
                            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                            height = bottom - top;
                        }
                        if (top !== null && height !== null && parent !== null) {
                            // cook up a div (if necessary) and position it 
                            let div = window.document.getElementById("code-annotation-line-highlight");
                            if (div === null) {
                                div = window.document.createElement("div");
                                div.setAttribute("id", "code-annotation-line-highlight");
                                div.style.position = 'absolute';
                                parent.appendChild(div);
                            }
                            div.style.top = top - 2 + "px";
                            div.style.height = height + 4 + "px";
                            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                            if (gutterDiv === null) {
                                gutterDiv = window.document.createElement("div");
                                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                                gutterDiv.style.position = 'absolute';
                                const codeCell = window.document.getElementById(targetCell);
                                const gutter = codeCell.querySelector('.code-annotation-gutter');
                                gutter.appendChild(gutterDiv);
                            }
                            gutterDiv.style.top = top - 2 + "px";
                            gutterDiv.style.height = height + 4 + "px";
                        }
                        selectedAnnoteEl = annoteEl;
                    }
                };
                const unselectCodeLines = () => {
                    const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
                    elementsIds.forEach((elId) => {
                        const div = window.document.getElementById(elId);
                        if (div) {
                            div.remove();
                        }
                    });
                    selectedAnnoteEl = undefined;
                };
                // Attach click handler to the DT
                const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
                for (const annoteDlNode of annoteDls) {
                    annoteDlNode.addEventListener('click', (event) => {
                        const clickedEl = event.target;
                        if (clickedEl !== selectedAnnoteEl) {
                            unselectCodeLines();
                            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
                            if (activeEl) {
                                activeEl.classList.remove('code-annotation-active');
                            }
                            selectCodeLines(clickedEl);
                            clickedEl.classList.add('code-annotation-active');
                        } else {
                            // Unselect the line
                            unselectCodeLines();
                            clickedEl.classList.remove('code-annotation-active');
                        }
                    });
                }
                const findCites = (el) => {
                    const parentEl = el.parentElement;
                    if (parentEl) {
                        const cites = parentEl.dataset.cites;
                        if (cites) {
                            return {
                                el,
                                cites: cites.split(' ')
                            };
                        } else {
                            return findCites(el.parentElement)
                        }
                    } else {
                        return undefined;
                    }
                };
                var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
                for (var i = 0; i < bibliorefs.length; i++) {
                    const ref = bibliorefs[i];
                    const citeInfo = findCites(ref);
                    if (citeInfo) {
                        tippyHover(citeInfo.el, function () {
                            var popup = window.document.createElement('div');
                            citeInfo.cites.forEach(function (cite) {
                                var citeDiv = window.document.createElement('div');
                                citeDiv.classList.add('hanging-indent');
                                citeDiv.classList.add('csl-entry');
                                var biblioDiv = window.document.getElementById('ref-' + cite);
                                if (biblioDiv) {
                                    citeDiv.innerHTML = biblioDiv.innerHTML;
                                }
                                popup.appendChild(citeDiv);
                            });
                            return popup.innerHTML;
                        });
                    }
                }
            });
        </script>
        <nav class="page-navigation">
            <div class="nav-page nav-page-previous">
                <a href="./06_Numpy.html" class="pagination-link">
                    <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span
                            class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introducción a NumPy
                                </span></span>
                </a>
            </div>
            <div class="nav-page nav-page-next">
                <a href="./08_Matplotlib.html" class="pagination-link">
                    <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span
                            class="chapter-title">Visualización de datos con Matplotlib y Seaborn</span></span> <i class="bi bi-arrow-right-short"></i>
                </a>
            </div>
        </nav>
    </div>
    <!-- /content -->



</body>

</html>